/*! iptools-jquery-genericfilter - v0.0.4 - 2015-08-13
* https://github.com/interactive-pioneers/iptools-jquery-genericfilter
* Copyright Â© 2015 Interactive Pioneers GmbH; Licensed GPL */
!function(a){"use strict";function b(b,c){this.settings=a.extend({},u,c),this.$form=a(b),this._$lastTrigger=null,s(this),p(this)}function c(b){var c=b.data(w),d=c.replace(/([A-Za-z]+[\w\-\:\.]*)/g,"#$&");return a(d)}function d(b,c){var d=a.trim(c.val()),e=i(b,c),f=j(b,c,!1),g=l(f);return"0"===d||""===d||e&&!g?null:d}function e(b,d){var e=!1,f=c(b);return null===d?e:(f.each(function(){d.attr("id")===a(this).attr("id")&&(e=!0)}),e)}function f(b){var e=b.data,f=a(b.target),g=f.closest(e.settings.filterSelector),h=c(g),j=d(e,f),l=null===j,n=0===h.length&&!e.settings.noDependencyFilterTrigger,o=l||n;return e.clearDependencyChain(g,null===j),i(e,f)&&k(e,f),o&&q(e),e.updateResult(),m(e),o?!1:void 0}function g(a){var b=a.data;h(a),r(b)}function h(a){var b=a.data;n(b)}function i(a,b){var c=j(a,b,!0);return c.length>0}function j(a,b,c){var d=b.closest(a.settings.filterSelector),e=d.find('input[type="checkbox"]').not(c?b:"");return e}function k(b,c){var d=j(b,c,!0),e=c.data("params");d.each(function(){a(this).is(":checked")&&(e+="&"+encodeURIComponent(a(this).attr("name"))+"=on")}),c.data("params",e)}function l(b){var c=!1;return b.each(function(){a(this).is(":checked")&&(c=!0)}),c}function m(a){a.$form.find(v).attr("disabled","disabled")}function n(a){a.$form.find(v).removeAttr("disabled")}function o(a,b){var c=b||"";return a+"."+t+c}function p(a){a.$form.on(o("ajax:beforeSend"),v,a,f).on(o("ajax:complete"),v,a,h)}function q(a){a.$form.on(o("ajax:complete","temp"),a,g)}function r(a){a.$form.off(o("ajax:complete","temp"))}function s(b){b.$form.find(b.settings.filterSelector).each(function(){if("undefined"==typeof a(this).data(w))throw new Error("Required data attribute genericfilter-dependencies missing for "+a(this).attr("id"))})}var t="iptGenericFilter",u={noDependencyFilterTrigger:!1,filterSelector:".genericfilter__filter"},v="input, select, textarea",w="genericfilter-dependencies";b.prototype.clearDependencyChain=function(a,b){var d=c(a),f=e(a,this._$lastTrigger);return 0===d.length||f?void(this._$lastTrigger=null):(this.clearFilter(d,b),this._$lastTrigger=a,void this.clearDependencyChain(d,!0))},b.prototype.clearFilter=function(a,b){a.find(v).val(null),b&&a.empty()},b.prototype.updateResult=function(){this.$form.submit()},b.prototype.destroy=function(){this.$form.off(t),this.$form.removeData("plugin_"+t)},a.fn[t]=function(c){return this.each(function(){a.data(this,"plugin_"+t)||a.data(this,"plugin_"+t,new b(this,c))})}}(jQuery);