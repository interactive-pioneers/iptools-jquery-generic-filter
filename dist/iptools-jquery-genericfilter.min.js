/*! iptools-jquery-genericfilter - v0.0.1 - 2015-07-29
* https://github.com/interactive-pioneers/iptools-jquery-genericfilter
* Copyright Â© 2015 Interactive Pioneers GmbH; Licensed GPL */
!function(a){"use strict";function b(b,c){this.settings=a.extend({},o,c),this.$form=a(b),this._$lastTrigger=null,m(this.$form),l(this)}function c(b){var c=b.data(r),d=c.replace(/([A-Za-z]+[\w\-\:\.]*)/g,"#$&");return a(d)}function d(b){var c=a.trim(b.val()),d=g(b),e=h(b,!1),f=j(e);return"0"===c||""===c||d&&!f?null:c}function e(b,d){var e=!1,f=c(b);return null===d?e:(f.each(function(){d.attr("id")===a(this).attr("id")&&(e=!0)}),e)}function f(b){var e=b.data,f=a(b.target),h=f.closest(q),j=c(h),k=d(f);return e.clearDependencyChain(h,null===k),null===k||0===j.length&&!e.settings.noDependencyFilterTrigger?!1:(g(f)&&i(f),void e.updateResult())}function g(a){var b=h(a,!0);return b.length>0}function h(a,b){var c=a.closest(q),d=c.find('input[type="checkbox"]').not(b?a:"");return d}function i(b){var c=h(b,!0),d=b.data("params");c.each(function(){a(this).is(":checked")&&(d+="&"+encodeURIComponent(a(this).attr("name"))+"=on")}),b.data("params",d)}function j(b){var c=!1;return b.each(function(){a(this).is(":checked")&&(c=!0)}),c}function k(a){return a+"."+n}function l(a){a.$form.on(k("ajax:before"),p,a,f)}function m(b){b.find(q).each(function(){if("undefined"==typeof a(this).data(r))throw new Error("Required data attribute genericfilter-dependencies missing for "+a(this).attr("id"))})}var n="iptGenericFilter",o={noDependencyFilterTrigger:!1},p="input, select, textarea",q=".genericfilter__filter",r="genericfilter-dependencies";b.prototype.clearDependencyChain=function(a,b){var d=c(a),f=e(a,this._$lastTrigger);return 0===d.length||f?(this.updateResult(),void(this._$lastTrigger=null)):(this.clearFilter(d,b),this._$lastTrigger=a,void this.clearDependencyChain(d,!0))},b.prototype.clearFilter=function(a,b){a.find(p).val(null),b&&a.empty()},b.prototype.updateResult=function(){this.$form.submit()},b.prototype.destroy=function(){this.$form.off(n),this.$form.removeData("plugin_"+n)},a.fn[n]=function(c){return this.each(function(){a.data(this,"plugin_"+n)||a.data(this,"plugin_"+n,new b(this,c))})}}(jQuery);